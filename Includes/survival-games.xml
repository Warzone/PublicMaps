<!-- Base "Survival Games" include -->
<!-- Created by TheBestGamer, _Pear, Fishywishi, et al. -->
<!-- Include version 1.2.1 -->
<map>
<gamemode>sg</gamemode>
<objective>Be the last player standing.</objective>
<constants fallback="true"> <!-- Default values - Can be overriden by an individual map's code -->
    <constant id="timelimit">10m</constant>
    <constant id="player-count">24</constant> <!-- How many players this map is suited for based on podium counts. Common values: "8", "12", "24", "32", "48" -->
    <constant id="world-border-on">always</constant> <!-- Controls world border message. Can be set to "never" to turn off -->
    <constant id="world-border-time">4</constant>
    <constant id="grace-period">15s</constant> <!-- Controls how long the grace period is -->
    <constant id="chest-refill-timer">4m</constant> <!-- How often chests will be refilled-->
    <constant id="match-delay">10s</constant>
</constants>
<time>${timelimit}</time>
<blitz>
    <lives>1</lives>
    <broadcastLives>false</broadcastLives>
</blitz>
<players min="8" max="${player-count}" max-overfill="${player-count}" colors="true"/> <!-- max-overfill should always be the same as max, otherwise maps will run out of spawn slot for players and break -->
<broadcasts>
    <alert after="${world-border-time}m" filter="${world-border-on}">The world border has begun to shrink!</alert>
</broadcasts>
<filters>
    <all id="starting-countdown">
        <not>
            <countdown duration="${match-delay}" message="`3`lMatch will start in {0}" filter="match-running"/>
        </not>
        <match-running/>
    </all>
    <countdown id="grace-period-countdown" duration="${grace-period}" message="Grace period will end in {0}" filter="starting-countdown"/>
    <pulse id="chest-refill" period="${chest-refill-timer}" duration="1s" filter="match-started"/>
    <any id="allow-break">
        <material>leaves</material>
        <material>vine</material>
        <material>yellow flower</material>
        <material>red rose</material>
        <material>red mushroom</material>
        <material>brown mushroom</material>
        <material>double plant</material>
        <material>long grass</material>
        <material>dead bush</material>
    </any>
    <any id="chests">
        <material>chest</material>
        <material>trapped chest</material>
    </any>
    <all id="only-tier-1-chests">
        <filter id="chests"/>
        <negative>
            <region id="tier-2-chests"/>
        </negative>
    </all>
    <all id="only-tier-2-chests">
        <filter id="chests"/>
        <region id="tier-2-chests"/>
    </all>
</filters>
<actions>
    <trigger filter="starting-countdown" scope="player">
        <action scope="player">
            <message text="`7`l[`6`lSurvival `e`lGames`7`l] `3The games have started!"/>
        </action>
    </trigger>
    <trigger scope="player">
        <action scope="player">
            <message text="`7`l[`6`lSurvival `e`lGames`7`l] `3Grace Period is now over!"/>
        </action>
        <filter>
            <all>
                <not>
                    <filter id="grace-period-countdown"/>
                </not>
                <filter id="starting-countdown"/>
            </all>
        </filter>
    </trigger>
    <trigger scope="player">
        <action scope="player">
            <message text="`7`l[`6`lSurvival `e`lGames`7`l] `3Chests have been refilled!"/>
        </action>
        <filter>
            <all>
                <filter id="chest-refill"/>
                <time>${chest-refill-timer}</time>
            </all>
        </filter>
    </trigger>
</actions>
<regions>
    <!-- <apply leave="starting-countdown" region="spawn-cages"/> -->
    <apply block="allow-break" block-place="always"/>
</regions>
<lootables>
    <loot id="tier-1-chests-loottable">
        <any count="2..5" unique="true">
            <!-- Weapons -->
            <option weight="20">
                <item material="stone sword" unbreakable="true"/>
            </option>
            <option weight="25">
                <item material="stone axe" unbreakable="true"/>
            </option>
            <option weight="25">
                <item material="wood sword" unbreakable="true"/>
            </option>
            <option weight="15">
                <item material="bow" unbreakable="true"/>
            </option>
            <option weight="10">
                <item material="fishing rod" unbreakable="true"/>
            </option>
            <!-- Food -->
            <option weight="15">
                <item material="pork"/>
            </option>
            <option weight="15">
                <item material="raw beef"/>
            </option>
            <option weight="15">
                <item material="apple"/>
            </option>
            <option weight="10">
                <item material="cookie"/>
            </option>
            <option weight="10">
                <item material="pumpkin pie"/>
            </option>
            <option weight="15">
                <item material="raw fish"/>
            </option>
            <option weight="8">
                <item material="bread"/>
            </option>
            <option weight="15">
                <item material="carrot item"/>
            </option>
            <option weight="15">
                <item material="potato item"/>
            </option>
            <option weight="8">
                <item material="cooked beef"/>
            </option>
            <option weight="8">
                <item material="grilled pork"/>
            </option>
            <option weight="8">
                <item material="cooked fish"/>
            </option>
            <option weight="8">
                <item material="baked potato"/>
            </option>
            <option weight="5">
                <item material="golden apple"/>
            </option>
            <!-- Armor -->
            <option weight="25">
                <item material="leather helmet"/>
            </option>
            <option weight="20">
                <item material="leather chestplate"/>
            </option>
            <option weight="20">
                <item material="leather leggings"/>
            </option>
            <option weight="25">
                <item material="leather boots"/>
            </option>
            <option weight="15">
                <item material="gold helmet"/>
            </option>
            <option weight="10">
                <item material="gold chestplate"/>
            </option>
            <option weight="10">
                <item material="gold leggings"/>
            </option>
            <option weight="15">
                <item material="gold boots"/>
            </option>
            <option weight="5">
                <item material="iron helmet"/>
            </option>
            <option weight="5">
                <item material="iron boots"/>
            </option>
            <!-- Items -->
            <option weight="10">
                <item material="stick"/>
            </option>
            <option weight="8">
                <item material="iron ingot"/>
            </option>
            <option weight="8">
                <item material="gold ingot"/>
            </option>
            <option weight="8">
                <item material="feather"/>
            </option>
            <option weight="10">
                <item material="flint"/>
            </option>
            <option weight="5">
                <item material="diamond"/>
            </option>
            <any>
                <option weight="12">
                    <item material="arrow" amount="2"/>
                </option>
                <option weight="8">
                    <item material="arrow" amount="5"/>
                </option>
            </any>
        </any>
    </loot>
    <loot id="tier-2-chests-loottable">
        <any count="3..6" unique="true">
            <!-- Weapons -->
            <option weight="20">
                <item material="stone sword" unbreakable="true"/>
            </option>
            <option weight="25">
                <item material="stone axe" unbreakable="true"/>
            </option>
            <option weight="15">
                <item material="wood sword" unbreakable="true"/>
            </option>
            <option weight="15">
                <item material="iron sword" unbreakable="true"/>
            </option>
            <option weight="15">
                <item material="bow" unbreakable="true"/>
            </option>
            <option weight="15">
                <item material="fishing rod" unbreakable="true"/>
            </option>
            <!-- Food -->
            <option weight="10">
                <item material="pork"/>
            </option>
            <option weight="10">
                <item material="raw beef"/>
            </option>
            <option weight="5">
                <item material="pumpkin pie"/>
            </option>
            <option weight="8">
                <item material="raw fish"/>
            </option>
            <option weight="10">
                <item material="carrot item"/>
            </option>
            <option weight="15">
                <item material="cooked beef"/>
            </option>
            <option weight="15">
                <item material="baked potato"/>
            </option>
            <option weight="15">
                <item material="grilled pork"/>
            </option>
            <option weight="15">
                <item material="bread"/>
            </option>
            <option weight="8">
                <item material="golden apple"/>
            </option>
            <!-- Armor -->
            <option weight="20">
                <item material="leather helmet"/>
            </option>
            <option weight="15">
                <item material="leather chestplate"/>
            </option>
            <option weight="15">
                <item material="leather leggings"/>
            </option>
            <option weight="20">
                <item material="leather boots"/>
            </option>
            <option weight="15">
                <item material="gold helmet"/>
            </option>
            <option weight="15">
                <item material="gold chestplate"/>
            </option>
            <option weight="15">
                <item material="gold leggings"/>
            </option>
            <option weight="18">
                <item material="gold boots"/>
            </option>
            <option weight="10">
                <item material="iron helmet"/>
            </option>
            <option weight="10">
                <item material="iron chestplate"/>
            </option>
            <option weight="10">
                <item material="iron leggings"/>
            </option>
            <option weight="15">
                <item material="iron boots"/>
            </option>
            <!-- Items -->
            <option weight="10">
                <item material="stick"/>
            </option>
            <option weight="12">
                <item material="iron ingot"/>
            </option>
            <option weight="12">
                <item material="gold ingot"/>
            </option>
            <option weight="6">
                <item material="feather"/>
            </option>
            <option weight="10">
                <item material="flint"/>
            </option>
            <option weight="8">
                <item material="diamond"/>
            </option>
            <any>
                <option weight="8">
                    <item material="arrow" amount="2"/>
                </option>
                <option weight="15">
                    <item material="arrow" amount="5"/>
                </option>
            </any>
        </any>
    </loot>
    <fill loot="tier-2-chests-loottable" filter="only-tier-2-chests" refill-trigger="chest-refill" refill-clear="false"/>
    <fill loot="tier-1-chests-loottable" filter="only-tier-1-chests" refill-trigger="chest-refill" refill-clear="false"/>
</lootables>
<damage>
    <deny>
        <all>
            <any>
                <filter id="grace-period-countdown"/>
                <not>
                    <filter id="starting-countdown"/>
                </not>
            </any>
            <cause>melee</cause>
        </all>
    </deny>
</damage>
<itemremove>
    <item>sapling</item>
    <item>seeds</item>
    <item>red rose</item>
    <item>yellow flower</item>
    <item>double plant</item>
    <item>red mushroom</item>
    <item>brown mushroom</item>
    <item>long grass</item>
    <item>dead bush</item>
</itemremove>
<keep-potion-bottles/>
<mobs>
    <filter>
        <spawn>spawner</spawn>
    </filter>
</mobs>
<timelock>on</timelock>
</map>
